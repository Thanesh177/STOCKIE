<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style2.css') }}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Chart.js (for interactive chart from API data) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <!-- Make the API URL available to static/app.js -->
    <script>
      // Use same-origin backend endpoint so the browser calls App Runner,
      // and App Runner calls API Gateway (avoids CORS issues).
      window.PREDICT_API_URL = "{{ predict_api_url or '/predict' }}";
    </script>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
    <title>Second Page</title>
</head>
<body data-ticker="{{ (ticker or request.args.get('ticker') or '') | upper }}">
    <nav class="navbar">
        <ul>
            <li><a href="#stock">Summary</a></li>
            <li><a href="#news">News</a></li>
            <li><a href="#chart">Chart</a></li>
            <li><a href="#prediction">Prediction</a></li>
        </ul>
    </nav>

    <section id="stock">
        <div id="details"></div>

        <div class="main">
            <table>
                <tbody>
                    <tr>
                        <td><strong><p style="font-size: 1rem;">SUMMARY</p><br></strong>
                            {% if stock_data %}
                                {% for key, value in stock_data.items() %}
                                    <p style="margin-bottom: 10px;"><strong>{{ key }}:</strong> {{ value }}</p>
                                {% endfor %}
                            {% else %}
                                <p>No summary data available.</p>
                            {% endif %}
                        </td>
                        <br>
                        <br>
                     <td>
                    {% if s %}
                        {% for key, value in s.items() %}
                        <p style="margin-bottom: 10px;"><strong>{{ key }}:</strong> {{ value }}</p>
                        {% endfor %}
                    {% else %}
                        <p>No summary data available.</p>
                    {% endif %}
                    </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>

<section id="news">
    <div class="main2">
        <table>
            <thead>
                <tr>
                    <th><h1>NEWS</h1></th>
                </tr>
            </thead>
            {% for article in news %}
            <tr>
                <td><a href="{{ article.url }}" target="_blank">{{ article.title }}</a></td>
            </tr>
            {% endfor %}
        </table>
    </div>
</section>

<section id="chart">
    <div class="image-container">
        <canvas id="priceChart" style="width:100%; max-height:420px;"></canvas>
        <p id="chartError" style="text-align: center; font-weight: bold;"></p>
    </div>
</section>

<section id="prediction">
    <div class="third" style="color: black;">
        <p class="pre"><strong>AI Prediction for the Next Day:</strong> <span id="nextDayPrediction">â€”</span></p>
        <p class="pree">Disclaimer: The prediction shown here might be wrong, so don't make any decisions solely based on this data.</p>
    </div>
</section>
</body>
</html>
